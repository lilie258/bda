'''
概述
社会网络（Social network）：一组行动者（actors）及一组连接行动者的关系纽带（ties）的集合1
以节点代表行动者： 行动者 （即网络成员） 可以是网络中的任何社会单位或实体， 例如个体、 群体、 组织或者国家。
以节点之间的连线代表关系纽带： 关系纽带通常被概念化为一组社会关系， 代表网络成员之间的特定联系
社会网络分析social network analysis：
一种观察社会行动者之间的关系及关系模式的范式1， 重点是对社会行动者所构成的关系网络的可视化、 测量和分析。 

'''

'''
社会网络分析的主要步骤

问题提出:研究视角(解释性目标(表现差异与社会同质)与解释机制(结构主义与连接主义))
表现差异:关注社会联系如何解释不同行动者的表现，强调社会关系为网络中的个人提供的行动机会和可能性
社会同质:关注社会联系如何解释不同行动者的态度、信仰和实践的相似性
结构主义:强调联系的结构或配置，忽略联系的内容，专注联系的模式，通过行动者的网络位置来解释社会现象 
连接主义:关系纽带被视为信息和知识等资源流动的渠道，将行动者的成功归因于由其角色的联系所带来的资源，通过关系的性质和质量来解释社会现象

数据收集:
（一）社会网络应该包含哪些行动者？
限定网络成员的属性:
位置法：正式团队的成员作为参与人
声望法：有声望的信息提供者划定参与人
指定社会关系类型:
关系法：由行动者提名与其有特定关系的其他行动者作为参与人
参与特定事件:
事件法：定义事件，选择与事件相关的个体作为参与人
（二）如何收集社会网络数据？
向受访者询问与之相关联的人员信息:【某段时间】你通常与谁一起【做某件事】？他的【基本信息】你知道吗？你和这个人关系怎样？还有其他人吗？【联系人1】知道【联系人2】吗？
询问受访者特定社会关系的联系人信息:在你的亲戚、朋友、熟人中，有从事【某种】工作的人吗？你和这个人关系怎样？
询问具备某种资源或能力的联系人信息:你知道谁【具备某种资源或能力】吗？你和这个人关系怎样？ 
数据质量保障方法:
“测验-再测验”法:对受访者两次作答的名册匹配，比较两者不一致的程度，可与受访者进行确认和纠错
基于Jaccard系数的信度计算:两次提名中同时提及的人数，除以两次提名中不重复的总人数
多来源数据对比:通过多来源的数据比较数据的不一致程度
多来源数据对比基于互惠率的效度计算:可以计算联系双方都提及该联系的比率表示关系题项的效度
收集客观网络数据，避免主观数据偏差
(三)构建社会网络
(一）图示法
社会网络的分类：
关系是否具有方向性：有向网络 vs. 无向网络
关系是否体现强度差异：加权网络 vs. 无权网络
（二）矩阵法
邻接矩阵：表示社会网络关系的矩阵（A=(a_i,j)，i,j代表行动者）
行和列：社会行动者
行列对应的数值a_i,j ：行列对应社会行动者之间的关系权重（无向网络边的权重均为1）
有向图矩阵：横行表示关系的起点，纵列表示关系的终点
(四)明确社会网络分析指标
节点级分析:对节点所处的网络位置的分析:
度:每一个节点直接相连的边数
    注意:有向图要考虑边的方向,加权图的度是与该节点关联的边的权重之和
最短路径长度:两点之间边数最少的路径
    注意:加权图：成本型网络中最短路径长度等于权重之和的最小值，效率型网络中最短路径长度等于权重倒数之和的最小值
    有向网络的最短路径长度计算需要按方向来计算
局部集聚系数:测量无向网络图中三元闭包现象的关键指标（即朋友的朋友也是朋友的程度），量化了一个节点附近的集聚程度
节点i的局部集聚系数Ci的计算方式为以i为核心的闭合三元组的数量与所有三元组数量的比值
注意:对于没有方向的三元组,计算闭合三元组数量的时候不要重复计数
    三元组
        开放三元组：三点之间有两条关系连接
        闭合三元组：三点之间有三条关系连接
    三元闭包推理1（朋友的朋友也倾向于成为朋友）:对于开放三元组BAC，BA和CA关系存在，就有形成新的关系BC的趋势
中心度:通过分析网络中的关系分布、数量和距离，度量社会行动者占据网络中心地位的程度，对网络节点的“权力”进行量化分析
    度中心度:对节点所拥有的关系数量的简单计数，反映了一个人在网络中社会关系的多少
        度中心度越高，社会关系越多，往往代表这个人占据了更重要的网络位置，即他在网络中的嵌入度和参与度越高、社会资本越多、更容易发展新的社会关系和网络。
        节点i的绝对度中心度公式:绝对数
        节点i的相对度中心度公式:绝对数除以(n-1),n要理解为在整个社交网络中除了该点外的其他点的数量
    中介中心度:
    发现在网络中充当“桥梁”位置的节点，即在社会网络中控制或中介其他社会网络成员的信息流的位置。
    中介中心度越高，行动者控制或中介成员间信息流的能力越大，其他成员越依赖该行动者传递信息。
        节点i的绝对中介中心度:遍历所有节点组合,对每一对节点计算经过节点 i 的最短路径数量占这对节点所有最短路径数量的比例,再把所有节点组合的比例相加
        节点i的相对中介中心度:绝对中介中心度/[(n-1)*(n-2)]
    接近中心度:度量网络中的节点距离其他所有节点的远近程度
        接近中心度越高，代表行动者距离其他行动者越近，说明该行动者占据了通信效率更高的中心位置，在获取信息方面可选的信息来源和路径很多，独立性更高。
        节点i的绝对接近中心度：一个节点到网络中其他所有节点的最短路径长度之和的倒数
        最短路径长度之和越小,接近中心度越好,节点的独立性越高,通信效率越高
        节点i的相对接近中心度：(n-1)/绝对接近中心度
    特征向量中心度:在衡量行动者重要性的时候，将其关联之人的重要性纳入考量
        特征向量中心度越高，代表行动者所拥有的社会关系越重要

结构对等与相似性:
如果网络的两个顶点共享相同的社会关系，则它们在结构上是对等的（structural equivalence）
结构对等程度越高，行动者的社会位置越接近。
结构对等的程度可以通过量化节点之间的相似性程度（或差异程度）来反映
    相似程度可以看:
        Jaccard相似度:两个节点共有邻居与邻居总数的比值
        皮尔逊相关系数:cov/std(a)*std(b)
        欧几里得距离
        余弦相似度:a*b/|a|*|b| 夹角为0度，余弦值为1，代表两个向量完全相似；夹角为90度，余弦值为0，代表两个向量完全不相似


网络级分析:对社会网络整体结构及特征的分析:
平均度:所有节点的总度数与总节点数的比值
    反映网络中是否有很多连接良好的节点
    平均度越高，表示整个网络中平均每个行动者的社会关系越多，连接程度越高
    无向图的总度数为2m，平均度为2m/n
    有向图中，总出度=总入度=m，平均入度=平均出度=m/n
    加权图中计算平均加权度，即所有节点关联边的权重之和与总节点数的比值
密度:网络中实际的连线数与最大可能的连线数之比
    描述了社会网络中节点之间关联的紧密程度，密度越高，整个网络中行动者之间连接的紧密程度越高
    无向图中最多有n(n-1)/2条可能的连线，其密度为m/n(n−1)/2 
    有向图中最多有n(n-1)条可能的连线，其密度为m/n(n−1)
平均路径长度和网络直径:
平均路径长度（average path length），即任何两个节点之间的最短路径长度的平均值，该值越大，表示两个行动者之间通信的平均距离越长,网络整体的信息传输效率越低
网络直径（diameter）是网络图中的的最短路径长度的最大值，代表网络中两个最远的行动者之间的最短距离,反映网络的紧凑性
网络直径小所能反映的信息更可靠，节点数多的大图的紧凑性更有意义
全局/平均集聚系数:
全局和平均集聚系数是对图的整体集聚程度进行评估，是评估网络传递性（即网络中朋友的朋友也是朋友的程度）的重要指标，反映了网络凝聚力
全局集聚系数（global clustering coefficient）：整体图中闭合三元组的丰富度
全局集聚系数公式:闭合三元组数量*3/(闭合三元组数量*3+开放三元组的数量)
平均集聚系数（average clustering coefficient）：图中所有点的局部集聚系数的平均值
各点的局部集聚系数：
A和C的所有三元组都是闭合三元组，CA=1，CC=1
节点B有4个邻居节点，所有的三元组包括：ABC，ABD， ABE ，CBD，CBE，DBE，其中闭合三元组只有ABC，因此CB=1/6≈0.17
节点D、F仅有1个邻居节点，不存在局部集聚系数，不计入平均
节点E的邻居节点B、F之间没有连线，因此CE=0
平均集聚系数: (1+1/6+1+0)/4 ≈0.54
中心势:度量整体网络权力分布情况的中心性分析指标
衡量在网络中心度方面最占优势的行动者与其他行动者的差异程度。
    度中心势:度量在社会关系数量方面，最有优势的行动者与其他行动者的差异程度
        度中心势越大，表明网络中心节点在社会关系数量上的优势越强，网络中存在在社会关系数量方面占据主导地位的行动者
    中介中心势:度量在通信中介作用方面，最有优势的行动者与其他行动者的差异程度
        中介中心势越大，表明网络中心节点在中介他人通信路径方面的优势越强，网络中存在在中介他人通信路径方面占据主导地位的行动者
    接近中心势:度量在与其他行动者的接近程度(通信效率)方面，最有优势的行动者与其他行动者的差异程度
        接近中心势越大，表明网络中心节点 (相比其他节点)更靠近网络的其他成员，网络中存在在接近程度(通信效率)方面占据主导地位的行动者
凝聚子群分析:
    凝聚子群:行动者的子集，子集内部的行动者之间存在相对稳固的、直接的、强烈的、频繁的或积极的联系
    派系:任意两个成员之间的关系都是相互的（互惠关系），是凝聚力很高的子群
如果一个完备子图至少包含3个顶点以上，并且是“最大”的（maximal），即再多一个相邻顶点就会改变完备性，就称该子图的顶点集是一个派系
    k-派系:子群任意两个成员之间的距离不超过给定值 k(中间途经的其他成员不限于群体内部成员)
    k-宗派:子群网络直径小于等于 k 的k-派系
        子群任意两个成员之间的距离不超过给定值 k(中间途经的其他成员必须是群体内部成员)
        所有的k-宗派都是k-派系，但不是所有的k-派系都是k-宗派
    k-丛:子群中每个成员最多不与 k个成员连接的凝聚子群
        可以利用最小度数反推：子群中每个成员的组内联系数量不低于(子群成员数-k)
    k-核:子群中每个成员的组内联系数量不低于 k，即每个点在子图中的度数至少为k
        k-核可采用递归“剪枝”的过程获得
k 值越小，群体凝聚力越强
社区检测:找到内聚的子网络结构，组内成员之间有密集的连接，组间只有稀疏的连接，是一种“内紧外松”的结构
    Girvan-Newman算法:
        边介数（edge betweenness）：每对节点组合的最短路径中经过该边的最短路径所占比例之和。
            边介数高的边处于很多点对的最短路径中，往往是连接不同社区的桥梁
        算法主要思路：将这些介于不同社区之间的边删除，以将社区分离开
        算法主要步骤：计算所有边的边介数，将边介数最高的边删除，重复上述过程直至没有边可删除或者达到自定义的终止条件，最终可获得多个相互分离的网络组件（社区）
    Louvain算法:
        如果分区内部的边数明显多于期望的边数，或者分区之间的边数明显少于期望的边数，那么分区的划分就是有意义的。
        模块度（modularity）：计算了同一分区节点之间的实际边数与期望边数的差值之和（归一化结果），模块度越大，分区划分越有意义。
        设定每个节点为一个社区，对于每个节点，都考虑将其从自身社区中移除，移入邻居节点所处的不同社区中，计算移动后的模块度收益，最终将其移入可以使模块度收益增加最多的社区，重复这一过程，直至不能增加模块度收益
    核心-边缘结构分析:
        如果网络不能细分为排他性的、有凝聚力的子群体，要区分该群体内节点之间连接的疏密程度，可以开展核心—边缘结构分析，将该群体划分为核心区域和边缘区域
        理想结构可以是核心—核心节点彼此相连、核心—边缘节点彼此相连，边缘—边缘节点彼此无连接；或者核心节点之间才有联系，其他边缘节点均是孤立的。
        核心—边缘结构算法的核心思想是将节点分配至不同核心或边缘分区，使之最接近理想的核心—边缘结构
结构洞分析:
结构洞（structural holes）表示行动者之间非冗余的联系
跨越了结构洞的行动者，控制了关键信息扩散路径，可以从不同的集群获取非冗余的信息，更具有信息优势，这类节点被称为中间人（broker）
    有效规模和效率:度量联系人之间的非冗余程度
        自我网络：只包含中心节点和邻居节点、及所涉节点之间的边，又称自我网络，ego network，中心节点又称“自我”
        自我网络的冗余度计算：除自我点以外的节点在网络中的平均度
        冗余度redundancy=2t/n
        注：t是不包含自我点的联系数，n是不包含自我点的总节点数，也称为实际规模
        有效规模=实际规模-冗余度=n-2t/n
        效率（efficiency）= 有效规模/实际规模
    限制度:中心节点在多大程度上受到联系人的限制
        节点i受到节点j的限制：i在与j和p的联系中投放了时间和精力，但p也花费了时间和精力到联系人j身上
    层级度（hierarchy）：对自我点的限制集中于一个或几个特殊点时，就会出现网络层级，自我点的网络就会受到特定联系人的共享，降低自我点跨越结构洞的机会







'''